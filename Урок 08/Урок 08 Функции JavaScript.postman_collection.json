{
	"info": {
		"_postman_id": "37a326cf-1fcc-4fab-870a-027591679708",
		"name": "Урок 08 Функции JavaScript",
		"description": "## **Коллекция ДЗ Урок 8.** Функции JavaScript\n\n#### Задание 36.\n\nДана строка:\n\n``` javascript\nlet mar = 'море, море, океан, море, море, яхта';\n\n ```\n\nПолучить массив, в котором будут храниться все позиции (индексы), с которых подстрока \"_**море**_\" входит в исходную строку. Сформированный массив вывести в консоль.\n\n##### Запрос задания:\n\n- **GET ДЗ 36 Работа со строкой Консоль**\n    \n\n#### Задание 37.\n\n**DADATA**, поиск по фамилии. Отправить ресурсу **DADATA** запрос, тело которого имеет вид:\n\n``` json\n{\n  \"query\": \"Ан\"\n}\n\n ```\n\nНа основе полученного ответа от сервера создать 3 массива, в которых должны содержаться:\n\n- _**surname_arr**_ - фамилии\n- _**name_arr**_ - имена\n- _**patronymic_arr**_ - отчества\n    \n\nПолученные массивы вывести в консоль. Массивы не должны содержать пустых значений, только действительные.\n\n##### Запросы задания:\n\n- **POST ДЗ 37 DADATA Поиск по фамилии Результаты ответа в массив**\n    \n\n#### Задание 38.\n\n**JIRA**, метод _**getIssue**_. Обратиться к задаче _**TV-4**_ и получить дату ее создания. Проверить полученную дату на соответствие. Проверку провести двумя с пособами:\n\n- с помощью метода _**toDateString()**_\n- с помощью библиотеки _**moment**_\n    \n\n##### Запросы задания:\n\n- **GET ДЗ 38 JIRA getIssue Работа с датами Moment**\n    \n\n#### Задание 39.\n\n**USERS**, метод _**addTaskInCron**_. Отправить на ресурс **USERS** запрос, добавляющий созданную ранее задачу в расписание. Тело запроса имеет следующий вид:\n\n``` json\n{\n    \"email_owner\": emailOwner,\n    \"task_id\": idTask,\n    \"hours\": 14,\n    \"minutes\": 23,\n    \"month\": 3,\n    \"days\": 30,\n    \"day_weeks\": 0\n}\n\n ```\n\nНаписать автотесты, проверяющие, что:\n\n- В ответе сервера присутствует свойство **type** и его тип - _**строка**_.\n- Свойство **type** имеет значение _**success**_.\n- Свойство **message** содержит подстроки \"_**Расписание успешно добавлено в задачу**_\" и \"_**Следущая дата запуска**_\".\n- **Дата следующего запуска** задачи соответствует указанной при ее добавлении в расписание.\n    \n\n##### Запросы задания:\n\n- **POST ДЗ 39 USER addTaskInCron Добавление задачи в расписание**\n    \n\n##### Примечание:\n\n1. Необходимые для запроса сущности - _**пользователь**_, _**компания**_ и _**задача**_ - были созданы в _**Pre-request Script**_'е запроса с помощью метода _**sendRequest()**_ объекта **pm**.\n2. При передаче даты следующего запуска задачи не указывается год. Он вычисляется системой, исходя из того, в каком году число и месяц будут соответствовать определенному дню недели. Для вычисления года даты по имеющимся числу, месяцу и дню недели была реализована функция _**setDate()**_.\n3. В функции _**setDate()**_ используется библиотека **moment**.\n    \n\n#### Задание 40.\n\n**SHOP,** метод _**search**_. В _**Pre-request Script**_'е запроса с помощью метода _**sendRequest()**_ объекта **pm** создать _**рандомное**_ количество товара в диапазоне от **1** до **10** (метод _**create**_ ресурса **SHOP**).\n\nВыполнить запрос _**search**_. Для полученного ответа сервера написать следующие автотесты:\n\n- Количество товара, полученного по запросу _**search**_, соответствует количеству созданного в _**Pre-request Script**_'е товара.\n- **id** полученных по запросу _**search**_ товаров соответствуют **id** созданных в _**Pre-request Script**_'е товаров.\n    \n\nПо окончании проверки необходимо **удалить** все созданные ранее в _**Pre-request Script**_'е товары.\n\n##### Примечание:\n\nЗапросы\n\n- **ДЗ 40-1 SHOP SELECT items из БД Для проверки**\n- **ДЗ 40-2 SHOP DELETE Item Для проверки**\n    \n\nвспомогательные и служат для ручного отбора и удаления товара в процессе отладки основного запроса.\n\n##### Запрос задания:\n\n- **POST ДЗ 40 SHOP search Поиск товаров**\n    \n\n##### Примечание:\n\n1. Запросы к ресурсу **JIRA** требуют авторизации. Параметры авторизации хранятся и заполняются в глобальных переменных _**ATL_USERNAME**_ и _**ALT_PSW**_, метод авторизации в запросах - **Basic Auth**.\n2. Запросы к ресурсу **DADATA** требуют авторизации. Параметры авторизации хранятся и заполняются в глобальных переменных **DADATA_AUTH_KEY** и **DADATA_AUTH_VALUE**, метод авторизации в запросах - **API Key**.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "23386398",
		"_collection_link": "https://lively-capsule-55441.postman.co/workspace/%25D0%2590%25D0%25B2%25D1%2582%25D0%25BE%25D0%25BC%25D0%25B0%25D1%2582%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F-%25D1%2582%25D0%25B5%25D1%2581%25D1%2582%25D0%25BE%25D0%25B2-%25D0%25B4%25D0%25BB%25D1%258F-REST-A~f0af8592-a4dc-4fe3-aed5-135832153c62/collection/23386398-37a326cf-1fcc-4fab-870a-027591679708?action=share&source=collection_link&creator=23386398"
	},
	"item": [
		{
			"name": "ДЗ",
			"item": [
				{
					"name": "ДЗ 36 Работа со строкой Консоль",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"console.clear();\r",
									"let findStr = 'море'; // искомая подстрока\r",
									"let delimiterLength = 2; // длина разделителя (', ')\r",
									"let dataStr = 'море, море, океан, море, море, яхта'; // строка поиска\r",
									"let curIndex=0; // начальная позиция для поиска в строке поиска\r",
									"let arrFindedStartIndex = []; // массив с начальными позициями найденных подстрок в строке поиска\r",
									"\r",
									"while (curIndex > -1) { // пока поиск дает результаты... \r",
									"  curIndex = dataStr.indexOf(findStr, curIndex); // получаем текущую позицию найденной подстроки в строке поиска \r",
									"  if (curIndex > -1) { // если эта позиция больше -1 (т.е. нашли очередное вхождение)\r",
									"    arrFindedStartIndex.push(curIndex); // добавляем эту позицию в массив \r",
									"    curIndex += findStr.length + delimiterLength; // увеличиваем позицию старта следующего поиска на длину искомой подстроки и длину разделеителя (хотя, в принципе, длину разделителя можно и не учитывать, если длина этого разделителя непостоянна); лучше вместо длины разделителя делать +1 к findStr.length\r",
									"  }\r",
									"}\r",
									"\r",
									"console.log(arrFindedStartIndex);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "postman-echo.com/get",
							"host": [
								"postman-echo",
								"com"
							],
							"path": [
								"get"
							]
						}
					},
					"response": []
				},
				{
					"name": "ДЗ 37 DADATA Поиск по фамилии Результаты ответа в массив",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"let jsonData = pm.response.json();\r",
									"let findName = JSON.parse(request.data)?.query;\r",
									"\r",
									"// Фильтруем полученный массив по surname, затем этот же массив модифицируем с помощью map и оставляем в нем вместо объектов только значения surname\r",
									"// suggestions?. - может отсутствовать, если код не 200\r",
									"// .filter()?.map() - отфильтрованный массив может быть пустым, если не найдены объекты с подходящим surname\r",
									"// surname может быть либо строкой, либо null, поэтому null для дальнейшего сравнения с подстрокой надо заменить на \" \"\r",
									"// отсюда запись: element.data.surname ? element.data.surname : \" \"\r",
									"let surname_arr = jsonData.suggestions?.filter(element => (element.data.surname ? element.data.surname : \" \").includes(findName))?.map(element => element.data.surname);\r",
									"\r",
									"let name_arr = jsonData.suggestions?.filter(element => (element.data.name ? element.data.name : \" \").includes(findName))?.map(element => element.data.name);\r",
									"\r",
									"let patronymic_arr = jsonData.suggestions?.filter(element => (element.data.patronymic ? element.data.patronymic : \" \").includes(findName))?.map(element => element.data.patronymic);\r",
									"\r",
									"console.log(\"Массив найденных фамилий: \", surname_arr);\r",
									"console.log(\"Массив найденных имен: \", name_arr);\r",
									"console.log(\"Массив найденных очеств: \", patronymic_arr);\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disabledSystemHeaders": {
							"accept": true
						}
					},
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "{{DADATA_AUTH_VALUE}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "{{DADATA_AUTH_KEY}}",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Authorization",
								"value": "Token 4814112383674f420d216d7ad6e9702f1852dd41",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"query\": \"Ан\",\r\n    \"count\": 20\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{DADATA_URL}}/fio",
							"host": [
								"{{DADATA_URL}}"
							],
							"path": [
								"fio"
							]
						}
					},
					"response": []
				},
				{
					"name": "ДЗ 38 JIRA getIssue Работа с датами Moment",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const moment = require('moment');\r",
									"/* можно подключить библиотеку moment, работающую с датами; она входит в набор библиотек, присутствующих в Postman:\r",
									"ajv, atob, btoa, chai, cheerio, crypto-js, csv-parse/lib/sync, lodash, moment, postman-collection, tv4, uuid, xml2js,\r",
									"Наиболее часто используемые - lodash, ajv, chai, moment, crypto-js\r",
									"\r",
									"Также доступны следующие NodeJS модули:\r",
									"path, assert, buffer, util, url, punycode, querystring, string-decoder, stream, timers, events \r",
									"\r",
									"Если требуется сторонняя библиотека, то ее либо тянут по URL, либо ищут ее в варианте min и записывают в переменную, например, коллекции, а затем вызывают ее по мере необходимости\r",
									"*/\r",
									"\r",
									"let jsonData = pm.response.json();\r",
									"let date_result = new Date (2019, 11, 25); // месяц в js начинается с 0, поэтому не 12, а 11, если хотим декабрь\r",
									"let recivedDate = new Date(jsonData.fields.created); // из response полученную в виде строки дату переводим обратно в тип date\r",
									"\r",
									"console.clear();\r",
									"\r",
									"// функция, которая форматирует дату в строку вида ДД.ММ.ГГГГ\r",
									"let formatDate = date => ((date.getDate() < 10 ? '0' + date.getDate() : date.getDate()) + '.' + // день; если он < 10, добовляем '0'\r",
									"                          (date.getMonth() + 1 < 10 ? '0' + date.getMonth() + 1 : date.getMonth() + 1) + '.' + // месяц + 1, если < 10, добовляем '0' \r",
									"                           date.getFullYear()); // год полностью \r",
									"\r",
									"// с моей функцией\r",
									"pm.test(`Проверяемая дата ${formatDate(date_result)} соответствует возвращенной дате создания задачи`, function () {\r",
									"        pm.expect(formatDate(date_result)).to.eql(formatDate(recivedDate));\r",
									"});\r",
									"\r",
									"// с преобразованием в строку\r",
									"pm.test(`Проверяемая дата ${date_result.toDateString()} соответствует возвращенной дате создания задачи`, function () {\r",
									"        pm.expect(date_result.toDateString()).to.eql(recivedDate.toDateString());\r",
									"});\r",
									"\r",
									"// с использованием подключаемой библиотеки moment\r",
									"pm.test(`Проверяемая дата ${moment(date_result).format(\"DD-MM-YYYY\")} соответствует возвращенной дате создания задачи`, function () {\r",
									"        pm.expect(moment(date_result).format(\"DD-MM-YYYY\")).to.eql(moment(recivedDate).format(\"DD-MM-YYYY\"));\r",
									"});\r",
									"console.log(JSON.stringify(pm.request.toJSON(), null, 2));\r",
									"/*\r",
									"console.log((new Date(jsonData.fields.created)).getFullYear());\r",
									"console.log(moment(date_result).format(\"DD-MM-YYYY\"));\r",
									"*/\r",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "{{ALT_PSW}}",
									"type": "string"
								},
								{
									"key": "username",
									"value": "{{ATL_USERNAME}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{JIRA_URL}}/issue/:issueIdOrKey",
							"host": [
								"{{JIRA_URL}}"
							],
							"path": [
								"issue",
								":issueIdOrKey"
							],
							"variable": [
								{
									"key": "issueIdOrKey",
									"value": "TV-4"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "ДЗ 39 USER addTaskInCron Добавление задачи в расписание",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const moment = require('moment');\r",
									"let jsonData = pm.response.json();\r",
									"let specifiedHours = JSON.parse(request.data)?.hours;\r",
									"let specifiedMinutes = JSON.parse(request.data)?.minutes;\r",
									"let specifiedMonth = JSON.parse(request.data)?.month;\r",
									"let specifiedDays = JSON.parse(request.data)?.days;\r",
									"let specifiedDayWeeks = JSON.parse(request.data)?.day_weeks;\r",
									"\r",
									"let specifiedDate = moment().year(Date()).month(specifiedMonth - 1).date(specifiedDays).hour(specifiedHours).minute(specifiedMinutes).format(\"YYYY-MM-DD HH:mm\"); // дату собираем из тела запроса и добавляем к ней текущий год - moment().year(Date())\r",
									"\r",
									"/*\r",
									"  {\r",
									"    \"email_owner\": {{emailOwner}},\r",
									"    \"task_id\": {{idTask}},\r",
									"    \"hours\": 14,\r",
									"    \"minutes\": 23,\r",
									"    \"month\": 3,\r",
									"    \"days\": 30,\r",
									"    \"day_weeks\": 4 - воскресенье нулевой день недели\r",
									"  } - дата запуска вычисляется так: год вычисляется исходя из того, в каком году день-месяц будет соответствовать дню недели, т.е. ближайший год, когда 30 марта - четверг, - это 2023 год\r",
									"*/\r",
									"\r",
									"function setDate(initDate, dayWeek) { // в функцию передаем дату и день недели и до тех пор, пока день недели от даты не будет равен переданному дню недели, прибавляем к году переданной даты 1 год \r",
									"    while (moment(initDate).day() != dayWeek) {\r",
									"        initDate = moment(initDate).add(1, 'year').format(\"YYYY-MM-DD HH:mm\");\r",
									"    }\r",
									"    return moment(initDate).format(\"DD.MM.YYYY HH:mm\");\r",
									"}\r",
									"\r",
									"console.log(setDate(specifiedDate, specifiedDayWeeks));\r",
									"\r",
									"pm.test(\"В ответе есть свойство type и его тип - строка\", function () {\r",
									"    pm.expect(jsonData).to.have.property('type').that.is.an('string');\r",
									"});\r",
									"\r",
									"pm.test(\"Свойство type имеет значение 'success'\", function () {\r",
									"    pm.expect(jsonData.type.toLowerCase()).to.eql('success');\r",
									"});\r",
									"\r",
									"pm.test(\"Свойство message содержит строки 'Расписание успешно добавлено в задачу' и 'Следущая дата запуска'\", function () {\r",
									"    pm.expect(jsonData.message.toLowerCase()).to.includes('Расписание успешно добавлено в задачу'.toLowerCase()).and.includes('Следущая дата запуска'.toLowerCase());\r",
									"});\r",
									"\r",
									"let requestURL = pm.collectionVariables.get(\"idTask\");\r",
									"\r",
									"pm.test(`Дата следующего запуска задачи с id = ${pm.collectionVariables.get(\"idTask\")} - ${setDate(specifiedDate, specifiedDayWeeks)}`, function () {\r",
									"    pm.expect(jsonData.message).to.includes(JSON.parse(pm.collectionVariables.get(\"idTask\"))).and.includes(setDate(specifiedDate, specifiedDayWeeks));\r",
									"});\r",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// ФОРМИРУЕМ ПАРАМЕТРЫ ЗАПРОСА ДЛЯ СОЗДАНИЯ ПОЛЬЗОВАТЕЛЯ-ВЛАДЕЛЬЦА КОМПАНИИ\r",
									"\r",
									"let rndOwnerEmail = pm.variables.replaceIn('{{$randomEmail}}').toLowerCase(); // случайный e-mail владельца компании в нижнем регистре\r",
									"pm.collectionVariables.set(\"emailOwner\", JSON.stringify(rndOwnerEmail));\r",
									"\r",
									"let createUserOwnerRequestBody = {}; // тело запроса для создания пользователя-владельца компании\r",
									"// заполняем тело запроса для создания пользователя-владельца компании\r",
									"createUserOwnerRequestBody.email = rndOwnerEmail;\r",
									"createUserOwnerRequestBody.name = pm.variables.replaceIn('{{$randomFirstName}}'); //случайное имя\r",
									"createUserOwnerRequestBody.password = pm.variables.replaceIn('{{$randomInt}}'); // пароль (случайное число)\r",
									"\r",
									"// формируем сам запрос для создания пользователся\r",
									"const createUserOwnerRequest = {\r",
									"  url: 'http://users.bugred.ru/tasks/rest/doregister',\r",
									"  method: 'POST',\r",
									"  body: {\r",
									"    mode: 'raw',\r",
									"    raw: JSON.stringify(createUserOwnerRequestBody)\r",
									"  }\r",
									"};\r",
									"\r",
									"\r",
									"// ФОРМИРУЕМ ПАРАМЕТРЫ ЗАПРОСА ДЛЯ СОЗДАНИЯ КОМПАНИИ\r",
									"\r",
									"// функция, возвращающая случайное целое значение из диапазона min -> max, требуется нам для выбора типа компании\r",
									"let rndIntFromTo = (min, max) => (Math.floor(min + Math.random()*(max + 1 - min)));\r",
									"let companyType = ['ИП', 'ООО', 'ОАО']; // типы компаний\r",
									"let rndCompanyName = pm.variables.replaceIn('{{$randomWord}}'); // случайное слово для названия компании\r",
									"let rndCompanyType = companyType[rndIntFromTo(0, 2)]; // случайно выбранное значение из rndCompanyName\r",
									"let createCompanyRequestBody = {}; // тело запроса для создания компании\r",
									"let compUsers = [];\r",
									"compUsers.push(rndOwnerEmail);\r",
									"\r",
									"//Заполняем тело запроса для создания компании\r",
									"createCompanyRequestBody.company_name = rndCompanyName;\r",
									"createCompanyRequestBody.company_type = rndCompanyType;\r",
									"createCompanyRequestBody.company_users = compUsers;\r",
									"createCompanyRequestBody.email_owner = rndOwnerEmail;\r",
									"\r",
									"// формируем сам запрос для создания компании\r",
									"const createCompanyRequest = {\r",
									"  url: 'http://users.bugred.ru/tasks/rest/createcompany',\r",
									"  method: 'POST',\r",
									"  body: {\r",
									"    mode: 'raw',\r",
									"    raw: JSON.stringify(createCompanyRequestBody)\r",
									"  }\r",
									"};\r",
									"\r",
									"\r",
									"// ФОРМИРУЕМ ПАРАМЕТРЫ ЗАПРОСА ДЛЯ СОЗДАНИЯ ЗАДАЧИ И ЕЕ ПРИВЯЗКЕ К ПОЛЬЗОВАТЕЛЮ-ВЛАДЕЛЬЦУ КОМПАНИИ\r",
									"\r",
									"let createTaskRequestBody = {}; // тело запроса для создания задачи\r",
									"// заполняем тело запроса для создания задачи\r",
									"createTaskRequestBody.task_title = pm.variables.replaceIn('{{$randomWords}}'); // случайные слова для заголовка задачи\r",
									"createTaskRequestBody.task_description = pm.variables.replaceIn('{{$randomPhrase}}'); //случайные фразы для описания задачи\r",
									"createTaskRequestBody.email_owner = rndOwnerEmail; // создатель задачи\r",
									"createTaskRequestBody.email_assign = rndOwnerEmail; // кому назначена задача\r",
									"\r",
									"// формируем сам запрос для создания задачи\r",
									"const createTaskRequest = {\r",
									"  url: 'http://users.bugred.ru/tasks/rest/CreateTask',\r",
									"  method: 'POST',\r",
									"  body: {\r",
									"    mode: 'raw',\r",
									"    raw: JSON.stringify(createTaskRequestBody)\r",
									"  }\r",
									"};\r",
									"\r",
									"\r",
									"\r",
									"function fnSendRequest(requestParams) { // для отправки запроса создаем промис, чтобы управлять синхронностью, либо ассинхронностью\r",
									"    return new Promise((resolve, reject) => { // создаем промис\r",
									"        pm.sendRequest(requestParams, function (error, response) { // отправляем запрос\r",
									"            if (response.json().type === 'error') { // т.к. запрос на этот адрес всегда получает 200, то приходится анализировать тело ответа response.json()\r",
									"                reject(new Error(response.json().message)); //если в теле ответа есть type == 'error', то ошибка, создаем ошибку -> режект с ошибкой\r",
									"            } else {\r",
									"                console.log(response);\r",
									"                resolve(response.json()); // ошибки нет, резольв с успехом\r",
									"            }\r",
									"//            if (error) {reject(error)} else {resolve(response)} // так должно быть со стандартным запросом, возвращающим в случае ошибки error, а в случае успеха - response\r",
									"        });\r",
									"    });\r",
									"}\r",
									"\r",
									"async function asyncSendRequest(userOwner, company, task) {\r",
									"    try {\r",
									"        let resultUserOwner = await fnSendRequest(userOwner); // вызываем запрос создания владельца компании и ждем пока он выполнится\r",
									"        console.log(\"ОК. Пользователь успешно создан \", resultUserOwner);\r",
									"\r",
									"        let resultCompany = await fnSendRequest(company); // вызываем запрос создания компании и ждем пока он выполнится\r",
									"        console.log(\"ОК. Компания успешно создана \", resultCompany);\r",
									"\r",
									"        let resulTask = await fnSendRequest(task); // вызываем запрос создания задачи с привязкой к пользоватедю и ждем пока он выполнится\r",
									"        console.log(\"ОК. Задача успешно создана \", resulTask);\r",
									"\r",
									"        pm.collectionVariables.set(\"idTask\", `\"${JSON.stringify(resulTask.id_task)}\"`); // перекидываем id созданной задачи в переменную колекции, используем шаблонизатор, т.к. в основном запросе число - id задачи, передается в body как строка, т.е. \"95\"\r",
									"      \r",
									"    }\r",
									"    catch(err) {\r",
									"        console.log(err);\r",
									"    }\r",
									"}\r",
									"\r",
									"asyncSendRequest(createUserOwnerRequest, createCompanyRequest, createTaskRequest); // стартуем запросы с созданными ранее параметрами"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"email_owner\": {{emailOwner}},\r\n    \"task_id\": {{idTask}},\r\n    \"hours\": 14,\r\n    \"minutes\": 23,\r\n    \"month\": 3,\r\n    \"days\": 30,\r\n    \"day_weeks\": 0\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{USERS_URL}}/addtaskincron",
							"host": [
								"{{USERS_URL}}"
							],
							"path": [
								"addtaskincron"
							]
						}
					},
					"response": []
				},
				{
					"name": "ДЗ 40 SHOP search Поиск товаров",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"let jsonData = pm.response.json();\r",
									"let arrToDelItems = !pm.collectionVariables.get(\"arrItemsShop\") ? [] : JSON.parse(pm.collectionVariables.get(\"arrItemsShop\"));\r",
									"\r",
									"pm.test(`Количество созданного товара (${arrToDelItems.length} шт.) соответствует количеству товара, возвращенного сервером`, function () {\r",
									"    pm.expect(jsonData.result.length).to.eql(arrToDelItems.length);\r",
									"});\r",
									"\r",
									"for (let element of arrToDelItems) {\r",
									"    let fidedElement = jsonData?.result.find(el => el.id === element)?.id;\r",
									"    pm.test(`Товар с id =  ${element} присутствует в ответе сервера`, function () {\r",
									"    pm.expect(fidedElement).to.eql(element);\r",
									"});\r",
									"}\r",
									"\r",
									"for (let i = 0; i < arrToDelItems.length; i++) {\r",
									"    let deleteItemRequestBody = {\"id\": `${arrToDelItems[i]}`};\r",
									"    const deleteItemRequest = {\r",
									"        url: 'http://shop.bugred.ru/api/items/delete/',\r",
									"        method: 'POST',\r",
									"        body: {\r",
									"          mode: 'raw',\r",
									"          raw: JSON.stringify(deleteItemRequestBody)\r",
									"        }\r",
									"    };\r",
									"    pm.sendRequest(deleteItemRequest, function (err, res) {\r",
									"        console.log(err ? err : res.text());  // The console prints the request text\r",
									"    });\r",
									"}\r",
									"pm.collectionVariables.set(\"arrItemsShop\", undefined); //Чистим переменную коллекции с id созданных и уже удаленных товаров"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// функция, возвращающая случайное целое значение из диапазона min -> max, потребуется нам для задания случайного количества создаваемого товара\r",
									"let rndIntFromTo = (min, max) => (Math.floor(min + Math.random()*(max + 1 - min)));\r",
									"\r",
									"let arrSize = [40, 42, 44, 46, 48, 50, 60]; //стандартные размеры одежды \r",
									"\r",
									"\r",
									"// изображение товара в base64, конвертация - на ресурсе https://www.base64-image.de\r",
									"let picItem = \"data:image/jpeg;base64,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\";\r",
									"\r",
									"//Здесь можно было бы не оборачивать pm.sendRequest() в промис, но при создании лучше все же быть уверенным, что объект создан и проконтролировать этот процесс; при удалении же объекта как раз в нашем случае можно не оборачивать pm.sendRequest() в промис \r",
									"function fnSendRequest(requestParams) { // для отправки запроса создаем промис, чтобы управлять синхронностью, либо ассинхронностью\r",
									"    return new Promise((resolve, reject) => { // создаем промис\r",
									"        pm.sendRequest(requestParams, function (error, response) { // отправляем запрос\r",
									"            if (response.json().status === 'error') { // т.к. запрос на этот адрес всегда получает 200, то приходится анализировать тело ответа response.json()\r",
									"                reject(new Error(response.json().message)); //если в теле ответа есть status == 'error', то ошибка, создаем ошибку -> режект с ошибкой\r",
									"            } else {\r",
									"                console.log(response);\r",
									"                resolve(response.json()); // ошибки нет, резольв с успехом\r",
									"            }\r",
									"        });\r",
									"    });\r",
									"}\r",
									"\r",
									"async function asyncSendRequest(requestParams, arr) {\r",
									"    try {\r",
									"        let resultCreateItem = await fnSendRequest(requestParams); // вызываем запрос создания товара и ждем пока он выполнится\r",
									"        console.log(`ОК. Товар с id= ${resultCreateItem.result.id} (${resultCreateItem.result.name}) успешно создан `);\r",
									"\r",
									"        let arrForItems = !pm.collectionVariables.get(\"arrItemsShop\") ? [] : JSON.parse(pm.collectionVariables.get(\"arrItemsShop\"));// массив, в который будем записывать id созданного товара\r",
									"        arrForItems.push(resultCreateItem.result.id); // сохраняем id созданного товара в массив\r",
									"        pm.collectionVariables.set(\"arrItemsShop\", JSON.stringify(arrForItems)); //Сохраняем массив id созданных товаров в переменную коллекции\r",
									"    }\r",
									"    catch(err) {\r",
									"        console.log(err);\r",
									"    }\r",
									"}\r",
									"\r",
									"let rndIterationCount = rndIntFromTo(1, 10);\r",
									"\r",
									"for (let i=0; i < rndIterationCount; i++) {\r",
									"\r",
									"    // тело запроса для создания товара\r",
									"    let createItemRequestBody = {\r",
									"                                \"name\":`Лапсердак №${rndIntFromTo(1, 100)}`, //название со случайным номером от 1 до 100 \r",
									"                                \"section\":\"Верхняя одежда\",\r",
									"                                \"description\":\"Тот самый сюртук, который вешал на стул приснопамятный музыкант!\",\r",
									"                                \"color\":\"BLUE\",\r",
									"                                \"size\":`${arrSize[rndIntFromTo(0, 6)]}`, // случайный размер от 40-го до 50 и 60-го, случайный индекс массива определяет размер\r",
									"                                \"price\":`${pm.variables.replaceIn('{{$randomPrice}}')}`, // случайная цена\r",
									"                                \"params\":\"dress\"\r",
									"    };\r",
									"    createItemRequestBody.photo = picItem; // добавили фото для товара; можно создать несколько однотипных изображений товара, поместить их в массив и выбирать случайным образом функцией rndIntFromTo()\r",
									"\r",
									"    // формируем сам запрос для создания товара\r",
									"    const createItemRequest = {\r",
									"        url: 'http://shop.bugred.ru/api/items/create/',\r",
									"        method: 'POST',\r",
									"        body: {\r",
									"          mode: 'raw',\r",
									"          raw: JSON.stringify(createItemRequestBody)\r",
									"        }\r",
									"    };\r",
									"    asyncSendRequest(createItemRequest); // стартуем запрос созданния товаров\r",
									"}\r",
									"\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"query\": \"Лапсердак №\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{SHOP_URL}}/items/search/",
							"host": [
								"{{SHOP_URL}}"
							],
							"path": [
								"items",
								"search",
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "ДЗ 40-1 SHOP SELECT items из БД Для проверки",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"sql_query\": \"select * from items where title like '%лапсердак%';\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{SHOP_URL}}/items/select/",
							"host": [
								"{{SHOP_URL}}"
							],
							"path": [
								"items",
								"select",
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "ДЗ 40-2 SHOP DELETE Item Для проверки",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\"id\": 884}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{SHOP_URL}}/items/delete/",
							"host": [
								"{{SHOP_URL}}"
							],
							"path": [
								"items",
								"delete",
								""
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "idTask",
			"value": "",
			"type": "string"
		},
		{
			"key": "emailOwner",
			"value": "",
			"type": "string"
		},
		{
			"key": "arrItemsShop",
			"value": "",
			"type": "string"
		}
	]
}